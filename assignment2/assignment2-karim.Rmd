---
title: "assignment2-karim"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
options(digits=3)
```

Daan Moll (VU: 2559766 / UvA: 11929332)
Ramon Bussing (VU: 2687261 / UvA: 10719482)
Karim Semin (VU: ksn222 / UvA: 11285990)

Group number: 49


For all exercises, an $\alpha$ significance level of .05 is used, unless stated otherwise.

Exercise 1. Moldy bread
If left alone bread will become moldy, rot or decay otherwise. To investigate the influence of temperature and humidity on this process, the time to decay was measured for 18 slices of white bread, which were placed in 3 different environments and humidified or not. The data are given in the file bread.txt, with the first column time to decay in hours, the second column the environment (cold, warm or intermediate temperature) and the third column the humidity.
a) The 18 slices came from a single loaf, but were randomized to the 6 combinations of conditions. Present an R-code for this randomization process.

```{r}
bread = read.table("bread.txt",header=TRUE)
bread
```

The randomization process of the data is done as followed:
```{r}
I=3; J=2; N=3
rbind(rep(1:I,each=N*J),rep(1:J,N*I),sample(1:(N*I*J)))
```


b) Make two boxplots of hours versus the two factors and two interaction plots (keeping the two factors fixed in turn).
```{r}
attach(bread)
boxplot(hours~environment)
boxplot(hours~humidity)
```
```{r}
interaction.plot(environment, humidity, hours)
interaction.plot(humidity, environment, hours)
```


c) Perform an analysis of variance to test for effect of the factors temperature, humidity, and their interaction. Describe the interaction effect in words.

We define the alternative hypothesis as followed:
- There is an effect of environment's temperature on the decay of bread ($H_A$)
- There is an effect of humidity on the decay of bread ($H_B$)
- There is an interaction effect between the environments temperature and humidity on the decay of bread ($H_{AB}$)

To research these hypothesis, we need to determine the $F_A$, $F_B$ and $F_{AB}$ statistic with a two way ANOVA. 
```{r}
bread$environment=as.factor(bread$environment)
bread$humidity=as.factor(bread$humidity)

breadov=lm(hours~environment*humidity)
anova(breadov)
```
The p-value for both $H_0$ with factors $A_i =0$ and $B_j =0$ for all $i$ is <0.001. From this, we can conclude the the variation within different environments is much larger than within environments. The same can be concluded for humidity; the variation between a dry and wet environment is higher than within those two environments. Therfore a main effect is found for both variables and we may accept the alternative hypothesis that there is a significant relationship between a bread's environment and its decay, as well as between the humidity and decay of bread (within our confidence interval).

The p-value for the interaction effect between the factors $H0 :\gamma_{i,j} =0$ too is <0.001. From this, we may accept the alternative hypothesis that there is a interaction effect between the environment's temperature and humidity on the decay of the bread.

d) Which of the two factors has the greatest (numerical) influence on the decay? Is this a good question?

Based on the ANOVA of the two factors, it can be noted that the $F_A$ (233.7) is higher than $F_B$ (62.3). From this, we can conclude that more of the variance is explained by the environment's temperature than by humidity within their respective groups. Therefore, environment might have a greater influence on the decay. However, since an interaction effect was found between the two factors, this conclusion can not be made. (Because of this, "which of the two factors has the greatest influence is" is not a good question.) (TODO: dit nog checken met college)

e) Check the model assumptions by using relevant diagnostic tools. Are there any outliers?
Lastly, we check the model assumptions using relevant diagnostic tools. These assumptions consist of normality and equal variances of the residuals.
```{r}
qqnorm(residuals(breadov))
plot(fitted(breadov),residuals(breadov))
```
In the Q-Q plot, normality looks dubious. Moreover, the spread of variance looks relatively stable for all fitted values, which implies that there is no relationship between residuals and fitted values. Therefore, homogeneity of variance can be assumed. Nevertheless, some of the data points (marked with a red circle) look to be slightly extreme however. These may have a severely affect the normality of the data. We may consider these outliers and trim the data of these values.

